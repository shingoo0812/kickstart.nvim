
= conda direnvの設定=
`conda`と`direnv`を組み合わせて、特定のディレクトリに入ったときに自動的に`conda`環境を有効にする設定について説明します。この方法を使うと、プロジェクトディレクトリに移動するだけで、指定した`conda`環境が自動的に有効化され、簡単に環境を切り替えられます。

----------------------------------------------------------------------------
### 1. `direnv`のインストールと設定

----------------------------------------------------------------------------
#### 1.1 `direnv`のインストール
まず、`direnv`がインストールされていない場合は、以下のコマンドでインストールします。

```bash
# Ubuntu / Debian
`sudo apt install direnv`

# macOS
`brew install direnv`
```

----------------------------------------------------------------------------
#### 1.2 シェルの設定ファイルに`direnv`を追加

`direnv`を有効化するために、`.bashrc`や`.zshrc`などのシェルの設定ファイルに以下の一行を追加してください。

```bash
# bashの場合
`echo 'eval "$(direnv hook bash)"' >> ~/.bashrc`

# zshの場合
`echo 'eval "$(direnv hook zsh)"' >> ~/.zshrc`
```

その後、設定を反映させるためにシェルを再起動するか、次のコマンドを実行します。

```bash
`source ~/.bashrc  # bash`
`source ~/.zshrc   # zsh`
```

----------------------------------------------------------------------------
### 2. `.envrc`ファイルの作成と`conda`環境設定

`direnv`は、`.envrc`という設定ファイルを各プロジェクトディレクトリに置くことで、そのディレクトリ専用の環境設定を行います。ここに、使用したい`conda`環境の設定を記述します。

----------------------------------------------------------------------------
#### 2.1 `.envrc`ファイルを作成
プロジェクトのルートディレクトリに移動し、`.envrc`ファイルを作成して、次のように`conda`環境を指定します。

```bash
# プロジェクトディレクトリに移動
`cd /path/to/your/project`

# .envrcファイルを作成し、以下を追加
`echo 'layout conda myenv' > .envrc`
```

> `myenv`の部分は、使用したい`conda`環境の名前に置き換えてください。

----------------------------------------------------------------------------
#### 2.2 `direnv allow`で`.envrc`を許可
`.envrc`ファイルを作成または変更した後、`direnv allow`コマンドを実行して許可します。

```bash
`direnv allow .`
```

これで、プロジェクトディレクトリに移動するたびに自動的に`conda`環境がアクティブになります。

----------------------------------------------------------------------------
### 注意点

- `.envrc`内で指定した環境が正しく作成されていることを確認してください。存在しない環境を指定すると、エラーが発生します。
- 他のプロジェクトで別の`conda`環境を使いたい場合は、そのプロジェクトディレクトリの`.envrc`に異なる環境名を記述するだけでOKです。

----------------------------------------------------------------------------
### 補足: `direnv`の無効化
もし、ある時点で`direnv`を無効にしたい場合は、以下のコマンドでそのディレクトリの`.envrc`の設定を無効にできます。

```bash
`direnv deny .`
```

以上の設定で、`conda`と`direnv`を使って自動的にプロジェクトごとの環境が有効化されるようになります。
--------------------------------------------------------------------------
# .envrc

# Set the PATH to include local bin
`export PATH="$HOME/.local/bin:$PATH"`

# Initialize conda
`eval "$(conda shell.bash hook)"`

# Activate the conda environment
conda activate myenv  # myenvをあなたの環境名に置き換えてください

# Conda 環境を有効化するコマンド
`export PATH="$HOME/.local/bin:$PATH"`
`source "$(conda info --base)/etc/profile.d/conda.sh"  # Conda の初期化`
`conda activate myenv  # <環境名> を使用したい Conda 環境に置き換えてください`

